require("page.patient",function(e,t,i){function n(e){e?(d.addClass(this,"theme-elevation-8","theme-color-bg-A4"),d.removeClass(this,"theme-elevation-2","theme-color-bg-A1")):(d.removeClass(this,"theme-elevation-8","theme-color-bg-A4"),d.addClass(this,"theme-elevation-2","theme-color-bg-A1"))}function a(e){console.info("[page.patient] id=...",e)}function s(){d.clear("vaccins");var e,t,i;for(e in m.vaccins)t=m.vaccins[e].caption,i=d.div("theme-elevation-2","theme-color-bg-A1",[d.div([t]),d.div(["---"])]),d.add("vaccins",i),d.on(i,{down:n.bind(i,!0),up:n.bind(i,!1),tap:a.bind(i,e)})}var o,r=function(){function t(){return n(i,arguments)}var i={en:{},fr:{}},n=e("$").intl;return t.all=i,t}(),d=e("dom"),c=e("x-widget").getById,l=e("data"),u=e("wdg.modal"),v=e("format"),m=e("structure");i.onPage=function(){var e=location.hash.split("/"),t=e[1];o=l.getPatient(t),document.getElementById("patient.title").textContent=v.getPatientCaption(o);var i=document.getElementById("patient.hint"),n=c("patient.exit");if(n.visible=!1,Array.isArray(o.$admissions)&&0!=o.$admissions.length){var a=o.$admissions[o.$admissions.length-1];"undefined"==typeof a.exit?(i.innerHTML="Ce patient est admis dans ce service depuis<br/><b>"+v.date(a.enter)+"</b>.",n.visible=!0):i.innerHTML="Ce patient a été admis dans ce service du <ul><li><b>"+v.date(a.enter)+"</b></li><li>au <b>"+v.date(a.exit)+"</b>.</li></ul>"}else i.textContent="Ce patient n'a encore jamais été admis dans ce service.";s()},i.onNewVisit=function(){var e=l.getLastVisit(o);if(!e||e.exit)e=l.createVisit(o),location.hash="#Visit/"+o.$id;else{var t=d.div(["Une visite débutée ",d.tag("b",[v.date(e.enter)])," n'a pas été cloturée.",d.tag("br"),"Voulez-vous la poursuivre ?",d.tag("hr"),d.tag("em",["Si vous choisissez NON, nous créerons une nouvelle visite."])]);u.confirm(t,function(){location.hash="#Visit/"+o.$id},function(){e.exit=e.enter,l.createVisit(o),location.hash="#Visit/"+o.$id})}},t.exports._=r});
//# sourceMappingURL=page.patient.js.map