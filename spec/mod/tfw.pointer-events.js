require("tfw.pointer-events",function(t,e,o){function n(){return d(i,arguments)}function a(t){var e=this;this._slots={},this._eventListeners=[],Object.defineProperty(a.prototype,"element",{value:t,writable:!1,configurable:!0,enumerable:!0}),r.call(e,t,"touchstart",function(o){c.touchDevice=!0;var n=e._slots;1==o.touches.length&&(c.rect=t.getBoundingClientRect(),c.bodyMoveX=o.touches[0].clientX,c.bodyMoveY=o.touches[0].clientY,c.bodyDownX=o.touches[0].clientX,c.bodyDownY=o.touches[0].clientY,c.targetX=o.touches[0].clientX-c.rect.left,c.targetY=o.touches[0].clientY-c.rect.top,c.time=Date.now(),n.down&&n.down({action:"down",target:t,x:c.targetX,y:c.targetY,stopPropagation:o.stopPropagation.bind(o),preventDefault:o.preventDefault.bind(o)}))}),r.call(e,t,"touchmove",function(o){var n=c.bodyMoveX,a=c.bodyMoveY;c.bodyMoveX=o.touches[0].clientX,c.bodyMoveY=o.touches[0].clientY;var r=e._slots;r.drag&&r.drag({action:"drag",target:t,x0:c.targetX,y0:c.targetY,x:c.bodyMoveX-c.rect.left,y:c.bodyMoveY-c.rect.top,dx:c.bodyMoveX-c.bodyDownX,dy:c.bodyMoveY-c.bodyDownY,vx:c.bodyMoveX-n,vy:c.bodyMoveY-a,stopPropagation:o.stopPropagation.bind(o),preventDefault:o.preventDefault.bind(o)})}),r.call(e,t,"touchend",function(t){var o=e._slots,n=c.bodyMoveX-c.bodyDownX,a=c.bodyMoveY-c.bodyDownY;if(o.up&&o.up({action:"up",target:e.element,x:c.bodyMoveX-c.rect.left,y:c.bodyMoveY-c.rect.top,dx:n,dy:a,stopPropagation:t.stopPropagation.bind(t),preventDefault:t.preventDefault.bind(t)}),n*n+a*a<256){var r=Date.now();c.lastTapTime>0&&(o.doubletap&&r-c.lastTapTime<400?o.doubletap({action:"doubletap",target:e.element,x:c.bodyMoveX-c.rect.left,y:c.bodyMoveY-c.rect.top,stopPropagation:t.stopPropagation.bind(t),preventDefault:t.preventDefault.bind(t)}):c.lastTapTime=0),o.tap&&0==c.lastTapTime&&(t.stopPropagation(),t.preventDefault(),o.tap({action:"tap",target:e.element,x:c.bodyMoveX-c.rect.left,y:c.bodyMoveY-c.rect.top,stopPropagation:t.stopPropagation.bind(t),preventDefault:t.preventDefault.bind(t)})),c.lastTapTime=r}}),r.call(e,t,"mousedown",function(o){if(!c.touchDevice){var n=e._slots,a=t.getBoundingClientRect();c.target=e,c.targetX=o.clientX-a.left,c.targetY=o.clientY-a.top,n.down&&n.down({action:"down",target:t,x:c.targetX,y:c.targetY,stopPropagation:o.stopPropagation.bind(o),preventDefault:o.preventDefault.bind(o)})}}),r.call(e,t,"mousemove",function(o){var n=e._slots;if(n.move){var a=t.getBoundingClientRect(),r=o.target.getBoundingClientRect();n.move({target:t,action:"move",x:o.offsetX+r.left-a.left,y:o.offsetY+r.top-a.top})}}),Object.defineProperty(this,"element",{value:t,writable:!0,configurable:!0,enumerable:!0})}function r(t,e,o,n){t.addEventListener(e,o,n),this._eventListeners.push([t,e,o,n])}var i={en:{}},d=t("$").intl,l="onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",c={touchDevice:!1,target:null,targetX:0,targetY:0,bodyDownX:0,bodyDownY:0,bodyMoveX:-1,bodyMoveY:-1,bodyMoveLastX:-1,bodyMoveLastY:-1,onDrag:null,lastTapTime:0};document.body.addEventListener("mousedown",function(t){c.touchDevice||(c.bodyDownX=t.clientX,c.bodyDownY=t.clientY,c.bodyMoveX=t.clientX,c.bodyMoveY=t.clientY,c.bodyMoveLastX=t.clientX,c.bodyMoveLastY=t.clientY)},!0),document.body.addEventListener("mousemove",function(t){if(!c.touchDevice){c.bodyMoveLastX=c.bodyMoveX,c.bodyMoveLastY=c.bodyMoveY;var e=t.target.getBoundingClientRect();if(c.bodyMoveX=t.offsetX+e.left,c.bodyMoveY=t.offsetY+e.top,c.target){var o=c.target._slots;"function"==typeof o.drag&&o.drag({action:"drag",target:c.target.element,x0:c.targetX,y0:c.targetY,x:c.targetX+c.bodyMoveX-c.bodyDownX,y:c.targetY+c.bodyMoveY-c.bodyDownY,dx:c.bodyMoveX-c.bodyDownX,dy:c.bodyMoveY-c.bodyDownY,vx:c.bodyMoveX-c.bodyMoveLastX,vy:c.bodyMoveY-c.bodyMoveLastY})}}},!0),document.body.addEventListener("mouseup",function(t){if(!c.touchDevice&&c.target){t.stopPropagation(),t.preventDefault();var e=Date.now(),o=c.target._slots,n=c.bodyMoveX-c.bodyDownX,a=c.bodyMoveY-c.bodyDownY;o.up&&o.up({action:"up",target:c.target.element,x:c.targetX+n,y:c.targetY+a,dx:n,dy:a}),n*n+a*a<256&&(c.lastTapTime>0&&(o.doubletap&&e-c.lastTapTime<400?o.doubletap({action:"doubletap",target:c.target.element,x:c.targetX+n,y:c.targetY+a}):c.lastTapTime=0),o.tap&&0==c.lastTapTime&&o.tap({action:"tap",target:c.target.element,x:c.targetX+n,y:c.targetY+a}),c.lastTapTime=e),delete c.target}},!0),a.prototype.on=function(t,e){var o=this,n=this._slots;return"function"==typeof e&&(n[t]=e),"wheel"==t&&r.call(o,this.element,l,function(t){var e=o.element.getBoundingClientRect();n.wheel({target:o.element,action:"wheel",delta:t.deltaY,x:t.clientX-e.left,y:t.clientY-e.top,stopPropagation:t.stopPropagation.bind(t),preventDefault:t.preventDefault.bind(t)})}),this},a.prototype.off=function(){this._eventListeners.forEach(function(t){var e=t[0],o=t[1],n=t[2],a=t[3];e.removeEventListener(o,n,a)})},e.exports=a,e.exports._=n});
//# sourceMappingURL=tfw.pointer-events.js.map