require("input",function(e,t,n){function i(e,t,n,i){if(t.type&&"+"==t.type.charAt(t.type.length-1))return void r(t,n,i);var a=c.getValue(n,t.id),d=p(t.type),o=new s({wide:!0,label:t.caption,list:d.list,placeholder:v.expand(a.old,t.type),value:v.expand(a.new,t.type)});l.bind(o,"value",function(e){if("string"==typeof e){if(e=e.trim(),0==e.length)delete i.data[t.id];else{var n=d.map[e.toLowerCase()];i.data[t.id]=n||e}c.save()}}),f.add(e,f.div([f.div([t.caption]),f.div([o])])),r(e,o,t,n,i)}function r(e,t,n,i,r){for(var p=n,u=n,f=0,l={},c=a(y.types[n.type],l);null!=(u=o(p));)t=d(e,r,l,t,i,n,u,f,c),f++,p=u}function a(e,t,n,i,r){if("undefined"==typeof e)return[];"undefined"==typeof n&&(n=0),"undefined"==typeof i&&(i=[]),i.length<=n&&i.push({});var d,o;for(d in e.children)o=e.children[d],t[o.caption.trim().toUpperCase()]=d,n>0&&(i[n-1][r]?i[n-1][r].push(o.caption):i[n-1][r]=[o.caption]),a(o,t,n+1,i,d);return i}function d(e,t,n,i,r,a,d,o,p){var u=y.types[a.type],h=c.getValue(r,d.id),g=new s({wide:!0,label:a.caption,placeholder:v.expand(h.old,u,o),value:v.expand(h.new,u,o)});return l.bind(g,"focus",function(e){if(e){var t=i.value.trim().toUpperCase(),r=n[t];g.list=p[o][r||t]||[]}}),l.bind(g,"value",function(e){if("string"==typeof e){if(e=e.trim(),0==e.length)delete t.data[d.id];else{var i=n[e.trim().toUpperCase()];t.data[d.id]=i||e}c.save()}}),f.add(e,f.div([f.div([d.caption]),f.div([g])])),g}function o(e){if("undefined"==typeof e.children)return null;var t;for(t in e.children)return e.children[t];return null}function p(e){if("undefined"==typeof e)return g;if(e=y.types[e],"undefined"==typeof e)return g;if(e=e.children,"undefined"==typeof e)return g;var t,n,i=[],r={};for(t in e)n=e[t],i.push(n.caption),r[n.caption.toLowerCase()]=t;return i.sort(),{list:i,map:r}}var u=function(){function t(){return i(n,arguments)}var n={en:{},fr:{}},i=e("$").intl;return t.all=n,t}(),f=e("dom"),l=e("tfw.data-binding"),c=e("data"),s=e("wdg.text"),v=e("format"),y=e("structure"),h=function(e){var t,n=f.elem(this,"div","input");if("undefined"==typeof e.patient)throw Error("[input] Missing mandatory argument: `patient`!");var r=e.patient;t=c.getLastVisit(r);var a=e.def;i(n,a,r,t)},g={list:[],map:{}};t.exports=h,t.exports._=u});
//# sourceMappingURL=input.js.map