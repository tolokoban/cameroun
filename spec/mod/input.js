require("input",function(e,t,n){function i(){return l(f,arguments)}function r(e,t,n,i){if(t.type&&"+"==t.type.charAt(t.type.length-1))return void a(t,n,i);var r=v.getValue(n,t.id),d=u(t.type),o=new y({wide:!0,label:t.caption,list:d.list,placeholder:h.expand(r.old,t.type),value:h.expand(r.new,t.type)});s.bind(o,"value",function(e){if("string"==typeof e){if(e=e.trim(),0==e.length)delete i.data[t.id];else{var n=d.map[e.toLowerCase()];i.data[t.id]=n||e}v.save()}}),c.add(e,c.div([c.div([t.caption]),c.div([o])])),a(e,o,t,n,i)}function a(e,t,n,i,r){for(var a=n,u=n,f=0,l={},c=d(g.types[n.type],l);null!=(u=p(a));)t=o(e,r,l,t,i,n,u,f,c),f++,a=u}function d(e,t,n,i,r){if("undefined"==typeof e)return[];"undefined"==typeof n&&(n=0),"undefined"==typeof i&&(i=[]),i.length<=n&&i.push({});var a,o;for(a in e.children)o=e.children[a],t[o.caption.trim().toUpperCase()]=a,n>0&&(i[n-1][r]?i[n-1][r].push(o.caption):i[n-1][r]=[o.caption]),d(o,t,n+1,i,a);return i}function o(e,t,n,i,r,a,d,o,p){var u=g.types[a.type],f=v.getValue(r,d.id),l=new y({wide:!0,label:a.caption,placeholder:h.expand(f.old,u,o),value:h.expand(f.new,u,o)});return s.bind(l,"focus",function(e){if(e){var t=i.value.trim().toUpperCase(),r=n[t];l.list=p[o][r||t]||[]}}),s.bind(l,"value",function(e){if("string"==typeof e){if(e=e.trim(),0==e.length)delete t.data[d.id];else{var i=n[e.trim().toUpperCase()];t.data[d.id]=i||e}v.save()}}),c.add(e,c.div([c.div([d.caption]),c.div([l])])),l}function p(e){if("undefined"==typeof e.children)return null;var t;for(t in e.children)return e.children[t];return null}function u(e){if("undefined"==typeof e)return w;if(e=g.types[e],"undefined"==typeof e)return w;if(e=e.children,"undefined"==typeof e)return w;var t,n,i=[],r={};for(t in e)n=e[t],i.push(n.caption),r[n.caption.toLowerCase()]=t;return i.sort(),{list:i,map:r}}var f={en:{},fr:{}},l=e("$").intl,c=e("dom"),s=e("tfw.data-binding"),v=e("data"),y=e("wdg.text"),h=e("format"),g=e("structure"),m=function(e){var t,n=c.elem(this,"div","input");if("undefined"==typeof e.patient)throw Error("[input] Missing mandatory argument: `patient`!");var i=e.patient;t=v.getLastVisit(i);var a=e.def;r(n,a,i,t)},w={list:[],map:{}};t.exports=m,t.exports._=i});
//# sourceMappingURL=input.js.map