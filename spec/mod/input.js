require("input",function(t,e,i){function n(t,e,i,n){if(e.type&&"+"==e.type.charAt(e.type.length-1))return void r(e,i,n);var a=c.value(i,e.id),o=l(e.type),d=new f({wide:!0,label:e.caption,list:o.list,placeholder:s.expand(a.old,e.type),value:s.expand(a.new,e.type)});v.bind(d,"value",function(t){if("string"==typeof t){if(t=t.trim(),0==t.length)delete n.data[e.id];else{var r=o.map[t.toLowerCase()];n.data[e.id]=r||t}c.save(i)}}),p.add(t,p.div([p.div([d])])),r(t,d,e,i,n)}function r(t,e,i,n,r){for(var l=i,u=i,p=0,v={},f=a(h.value.types[i.type],v);null!=(u=d(l));)e=o(t,r,v,e,n,i,u,p,f),p++,l=u}function a(t,e,i,n,r){if(void 0===t)return[];void 0===i&&(i=0),void 0===n&&(n=[]),n.length<=i&&n.push({});var o,d;for(o in t.children)d=t.children[o],e[d.caption.trim().toUpperCase()]=o,i>0&&(n[i-1][r]?n[i-1][r].push(d.caption):n[i-1][r]=[d.caption]),a(d,e,i+1,n,o);return n}function o(t,e,i,n,r,a,o,d,l){var u=h.value.types[a.type],y=c.value(r,o.id),m=new f({wide:!0,label:o.caption+"  ("+a.caption+")",placeholder:s.expand(y.old,u,d),value:s.expand(y.new,u,d)});return v.bind(m,"focus",function(t){if(t){var e=n.value.trim().toUpperCase(),r=i[e];m.list=l[d][r||e]||[]}}),v.bind(m,"value",function(t){if("string"==typeof t){if(t=t.trim(),0==t.length)delete e.data[o.id];else{var n=i[t.trim().toUpperCase()];e.data[o.id]=n||t}c.save(r)}}),p.add(t,m),m}function d(t){if(void 0===t.children)return null;var e;for(e in t.children)return t.children[e];return null}function l(t){if(void 0===t)return m;if(t=h.value.types[t],void 0===t)return m;if(t=t.children,void 0===t)return m;var e,i,n=[],r={};for(e in t)i=t[e],n.push(i.caption),r[i.caption.toLowerCase()]=e;return n.sort(),{list:n,map:r}}var u=function(){function e(){return n(i,arguments)}var i={en:{},fr:{}},n=t("$").intl;return e.all=i,e}(),p=t("dom"),v=t("tfw.data-binding"),f=t("wdg.text"),s=t("format"),c=t("patients"),h=t("structure"),y=function(t){var e,i=p.elem(this,"div","input");if(void 0===t.patient)throw Error("[input] Missing mandatory argument: `patient`!");var r=t.patient;e=c.lastVisit(r),n(i,t.def,r,e)},m={list:[],map:{}};e.exports=y,e.exports._=u});
//# sourceMappingURL=input.js.map