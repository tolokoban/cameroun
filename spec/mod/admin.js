require("admin",function(e,n,t){var o=function(){function n(){return o(t,arguments)}var t={en:{"title-home":"Administration page"},fr:{"title-home":"Page d'administration"}},o=e("$").intl;return n.all=t,n}();e("font.josefin"),e("font.mystery-quest");var i=e("dom"),a=e("x-widget").getById,r=e("tfw.web-service"),s=(e("tfw.data-binding"),e("$"),e("tfw.message").error),u=e("tfw.message").info,d=e("wdg.area"),c=e("wdg.modal"),l=e("structure.parser"),f=e("structure"),m={types:"Types de données",patient:"Champs liés au patient",forms:"Formulaire de visite",vaccins:"Liste des vaccins",exams:"Détail des examens possibles"},v={};t.onPage=function(e){return console.info("[admin] pageId=",e),"Admin"!=e?void window.setTimeout(function(){a("username").focus=!0},100):void f.then(function(){var e,n,t;for(e in m)n=m[e],t=new d({label:n,value:f.source[e]}),v[e]=t,i.add("body."+e,t)})},t.onSave=function(){var e=new c({padding:!0,content:["Sauvegarde en cours..."]});e.attach(),window.setTimeout(function(){var n,t,o=[];for(n in m)t=v[n],console.info("[admin] key=",n),console.info("[admin] val=",t),o.push({id:n,text:t.value,area:t}),console.info("[admin] tasks=",o);var i=function(){if(0==o.length)return void e.detach();var n=o.shift();try{l.parse(n.text)}catch(t){return e.detach(),void c.alert("<html>Il y a une erreur dans le code de <b>"+m[n.id]+"</b> à la ligne <b>"+t.lineNumber+".<pre class='error'>"+t.message+"</pre>",function(){n.area.focus=!0})}r.get("PutOrg",n).then(function(e){console.info("[admin] ret=...",e),f.value[n.id]=n.text,i()},function(e){console.info("[admin] err=...",e),s(e)})};i()})},t.onLogin=function(){var e=a("username").value,n=a("password").value;r.login(e,n).then(function(e){u("Bienvenue !"),f.then(function(){location.hash="#Admin"},function(e){e.context="Loading...",console.error(e),c.alert(o("loading-error",JSON.stringify(e,null,"  ")))})},function(e){console.error(e),s("L'authentification a échoué !"),window.setTimeout(function(){location="index.html"},3e3)})},n.exports._=o});
//# sourceMappingURL=admin.js.map