require("structure",function(t,r,e){function n(t){p={},d={};var r,e;for(r in t){e=t[r],"string"!=typeof e&&(e="");try{d[r]=e,p[r]=c.parse(e),console.info("[structure] exports[",r,"]=",p[r])}catch(t){return s.alert(u.div(["Error in structure `"+r+"` at line "+t.lineNumber,u.tag("code",[t.message])])),!1}}return!0}var o=function(){function r(){return n(e,arguments)}var e={en:{},fr:{}},n=t("$").intl;return r.all=e,r}();t("polyfill.promise");var u=t("dom"),i=(t("tfw.web-service"),t("files")),s=t("wdg.modal"),c=t("structure.parser"),a=(t("tfw.storage").session,t("node://fs")),f="data/structure.json",l="http://tolokoban.org/Cameroun/tfw/svc.php?s=GetOrg",p=null,d=null;r.exports=new Promise(function(t,r){p?t(p):i.mkdir("data").then(function(){return fetch(l)}).then(function(t){if(0==t.ok)throw"Error "+t.status+" - "+t.statusText;return t.json()}).then(function(r){if(!n(r))throw"Unparsable JSON!";a.writeFile(f,JSON.stringify(r,null,"    ")),t(p)}).catch(function(e){a.existsSync(f)?a.readFile(f,function(e,o){e?r("Unable to read backup file for structure!\n"+e):(n(JSON.parse(o.toString())),t(p))}):r("No connection and no structure in cache!")})}),Object.defineProperty(r.exports,"value",{get:function(){return p},set:function(t){}}),Object.defineProperty(r.exports,"source",{get:function(){return d},set:function(t){}}),r.exports._=o});
//# sourceMappingURL=structure.js.map