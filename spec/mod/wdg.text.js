require("wdg.text",function(t,e,i){function a(){return o(l,arguments)}var l={en:{}},o=t("$").intl,n=t("dom"),s=t("tfw.data-binding"),r=t("tfw.timer").laterAction,d=function(t){var e=this,i=!1,a=[],l=0,o=n.div("theme-label","theme-color-bg-1"),d=n.tag("input"),v=n.div("datalist","theme-elevation-12");this._input=d;var u=n.elem(this,"div","wdg-text","theme-elevation-2",[o,d,v]);s.propString(this,"value")(function(t){d.value=t,e.validate()}),s.propEnum(["text","button","checkbox","color","date","datetime","email","file","hidden","image","month","password","radio","range","reset","search","submit","tel","time","url","week"])(this,"type")(function(t){n.att(d,{type:t})}),s.propStringArray(this,"list")(function(t){n.clear(v),n.removeClass(u,"list"),Array.isArray(t)&&(t.forEach(function(t){n.add(v,n.div([t]))}),t.length>0&&n.att(u,"list"))}),s.propValidator(this,"validator")(this.validate.bind(this)),s.propBoolean(this,"valid")(function(t){null!==t&&e.validator?t?(n.addClass(u,"valid"),n.removeClass(u,"no-valid")):(n.removeClass(u,"valid"),n.addClass(u,"no-valid")):n.removeClass(u,"valid","no-valid")}),s.propBoolean(this,"enabled")(function(t){t?n.removeAtt(d,"disabled"):n.att(d,{disabled:t})}),s.propInteger(this,"size")(function(t){t<1?n.removeAtt(d,"size"):n.att(d,{size:t})}),s.propString(this,"label")(function(t){null===t||"string"==typeof t&&""==t.trim()?n.addClass(u,"no-label"):(n.removeClass(u,"no-label"),n.textOrHtml(o,t),"<html>"==t.substr(0,6)?n.att(o,{title:""}):n.att(o,{title:t}))}),s.propString(this,"placeholder")(function(t){n.att(d,{placeholder:t})}),s.propString(this,"width")(function(t){u.style.width=t}),s.propBoolean(this,"focus")(function(t){t?d.focus():d.blur()}),s.propInteger(this,"action",""),s.propAddClass(this,"wide"),s.propRemoveClass(this,"visible","hide"),t=s.extend({value:"",type:"text",placeholder:"",enabled:!0,validator:null,valid:!0,list:null,label:"",placeholder:"",size:10,width:"auto",focus:!1,wide:!1,visible:!0},t,this);var c=function(){if(n.removeClass(u,"list"),e.list&&0!=e.list.length){n.clear(v);var t=e.list.map(String.toLowerCase),o=d.value.trim().toLowerCase();t=o.length>0?t.map(function(t,e){return[e,t.indexOf(o)]}).filter(function(t){return t[1]>-1}).sort(function(t,i){var a=t[1]-i[1];if(0!=a)return a;var l=e.list[t[0]],o=e.list[i[0]];return l<o?-1:l>o?1:0}).map(function(t){var i=e.list[t[0]],a=t[1];return i.substr(0,a)+"<b>"+i.substr(a,o.length)+"</b>"+i.substr(a+o.length)}):t.sort(),l>0&&(t=t.slice(l).concat(t.slice(0,l))),a=t,t.forEach(function(a,l){var o=n.div();o.innerHTML=a,t[l]=o.textContent.trim(),n.add(v,o),n.on(o,{down:function(){i=!0},up:function(){i=!1,e.focus=!0},tap:function(){e.value=o.textContent.trim(),console.info("[wdg.text] div=...",o),n.removeClass(u,"list")}})}),t.length>0?n.addClass(u,"list"):n.removeClass(u,"list")}},p=r(function(){e.value=d.value},300);d.addEventListener("keyup",function(t){13==t.keyCode?(t.preventDefault(),t.stopPropagation(),n.hasClass(u,"list")?(n.removeClass(u,"list"),e.value=a[0]):e.valid!==!1&&(s.fire(e,"value",d.value),s.fire(e,"action",d.value))):27==t.keyCode?(n.removeClass(u,"list"),l=0,t.preventDefault(),t.stopPropagation()):40==t.keyCode&&n.hasClass(u,"list")?(l=(l+1)%a.length,c(),t.preventDefault(),t.stopPropagation()):38==t.keyCode&&n.hasClass(u,"list")?(l=(l+a.length-1)%a.length,c(),t.preventDefault(),t.stopPropagation()):(l=0,c(),p.fire())}),d.addEventListener("blur",function(){e.value=d.value,i||n.removeClass(u,"list"),n.addClass(u,"theme-elevation-2"),n.removeClass(u,"theme-elevation-8"),n.removeClass(d,"theme-color-bg-A1"),e.focus=!1}),d.addEventListener("focus",function(){e.selectAll(),n.removeClass(u,"theme-elevation-2"),n.addClass(u,"theme-elevation-8"),n.addClass(d,"theme-color-bg-A1"),e.focus=!0}),d.addEventListener("keydown",function(t){}),this.validate()};d.prototype.validate=function(){var t=this.validator;if(t)try{this.valid=t(this.value)}catch(e){console.error("[wdg.text:validate] Exception = ",e),console.error("[wdg.text:validate] Validator = ",t)}},d.prototype.selectAll=function(){var t=this._input;return t.setSelectionRange(0,t.value.length),!0},e.exports=d,e.exports._=a});
//# sourceMappingURL=wdg.text.js.map